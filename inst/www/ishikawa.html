<!DOCTYPE html>
<html lang="en">
<head>
<title>QI Tools: Ishikawa diagram</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<!-- ocpu library -->
<script src="jquery/jquery-1.9.1.js"> </script>
<script src="opencpu/opencpu.js"> </script>

<!-- some optional styling stuff -->

<script src="bootstrap/js/bootstrap.js"> </script>
<script src="jqueryui/jquery-ui-1.10.3.custom.js"> </script>

<!-- Ajax.org Cloud9 Editor -->
<script src="src-min-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>

<script> 
$(function(){

  //optional, requires jquery-ui.
  //$("#plotdiv").resizable()

  //For Ajax.org Cloud9 Editor
  var editor = ace.edit("editor");
  editor.setTheme("ace/theme/github");
  editor.getSession().setMode("ace/mode/r");
  editor.setFontSize("14px");
  editor.getSession().setUseWrapMode(true);
  
  //button handler
  $("#plotbutton").on("click", function(e){
    e.preventDefault();
    $("#plotbutton").attr("disabled", "disabled")
    temp = editor.getSession().getValue()
	//temp = temp.replace(/\r?\n/g, '')
	//temp = temp.replace(/\s+$/g, '')
	//temp = temp.replace(/,$/g, '')
	var req = $('#target').contents().find('#plotdiv').r_fun_plot("ishikawa", {
	  content: temp
	  //content : encodeURIComponent(editor.getSession().getValue())
    }).always(function(){
      $("#plotbutton").removeAttr("disabled");
    }).fail(function(){
      alert("HTTP error " + req.status + ": " + req.responseText);
    });
  });
  
});
</script>
<style>
    body {
        overflow: hidden;
    }

#editor { 
  position: relative;
  width: 950px;
  height: 250px;
}
    
#plotdiv {
  width: 1000px;
  height: 400px;
  border: 1px solid #e3e3e3;
  border-radius: 4px;
}

#plotbutton{
  width: 120px;
  margin-left: 20px;
}

</style>
</head>

<body>
  <div class="container" style="width:1000px;">

    <div class="page-header">
      <h1>QI Tools</h1>
    </div>
    
    <div class="row">
      <div class="span3">

        <form class="well" id="paramform" target="target">
          <fieldset>
            <legend>Ishikawa Plot</legend>
            <div>Replace these examples of causes with your observations. The branches ('Provider', 'Patient', etc) can be removed, replaced, or added to.</div><br/>
<div id="editor">Provider=c('Distracted','Unaware','Inaccessible \n  knowledge','Nonparsable documentation','Not motivated','Not done: reason unknown'),

Patient=c('No visit during time period','Multiple complaints','TTM: early stage','HBM factor', 'No resource: _____'),

System=c('Acute vs continuity visit', 'Specialty vs primary care', 'Personnel absent','Supplies unavailable','Bean counting error'),

Personnel=c('Distracted','Inaccessible knowledge','Nonparsable documentation','Not done: reason unknown','Not motivated','Not empowered')
</div>	
            <br />
            
            <button class="btn btn-small btn-primary" id="plotbutton"><i class="icon-ok icon-white"></i> Update Plot</button>
          </fieldset>
        </form>
      </div>
<div id="">&nbsp;</div>
<iframe id="target" style="width:1000px;height:600px" name="target" width="700px" height="600px" src="output.html">
</iframe>
    </div>
     
    <div class="row">
      <div class="span12">
        <h3>About</h3>
        <p>This is a simple OpenCPU application. Below some example API's to access the R source code and manual pages.</p>
        
        <table class="table table-striped">
          <tr><th>Resource</th> <th>link</th> <th>API URL</th></tr>
          <tr><td>Package Info</td> <td><a href=".." target="blank">link</a></td> <td><code>GET /library/package</code></td> </tr>       
          <tr><td>Package Objects</td><td> <a href="../R" target="blank">link</a></td><td><code>GET /library/package/R</code></td></tr>           
          <tr><td>Function Source</td><td><a href="../R/qitools/print" target="blank">link</a></td><td><code>GET /library/package/R/function/print</code></td></tr>
          <tr><td>Help Page (txt)</td><td><a href="../man/qitools/text" target="blank">link</a></td><td><code>GET /library/package/man/function/text</code></td></tr>   
          <tr><td>Help Page (html)</td><td><a href="../man/qitools/html" target="blank">link</a></td><td><code>GET /library/package/man/function/html</code></td></tr>
          <tr><td>Help Page (pdf)</td><td><a href="../man/qitools/pdf" target="blank">link</a></td><td><code>GET /library/package/man/function/pdf</code></td></tr>          
        </table>
               
      </div>
    </div>
  </div>
</body>
</html>
